import tkinter
from tkinter import *
import mysql.connector
from tkinter import messagebox
from tkinter import ttk

main_database = mysql.connector.connect(
    host="localhost",
    user="root",
    passwd="Anciso-320910",
    database="login_database"
)
cursordb = main_database.cursor()
ncursor = main_database.cursor()
u_cursor = main_database.cursor()
s_cursor = main_database.cursor()
r_cursor = main_database.cursor()


def login_verification():
    user_verification = username_terminal.get()
    pass_verification = password_terminal.get()
    sql = "SELECT * FROM login_credentials WHERE username = %s and passowrd = %s"
    cursordb.execute(sql, [user_verification, pass_verification])
    results = cursordb.fetchall()
    if results:
        for i in results:
            messagebox.showinfo("Successful", f"Login complete, hello {username.get()}")
            frame.destroy()
            label.destroy()
            main.title("INVENTORY MANAGEMENT")
            main.iconphoto(True, d_icon)
            main.config(bg="#B1D0E0")
            new_frame = Frame(main)
            new_label = Label(new_frame, bg='white', height=35, width=80)
            Label(new_frame, bg='white', text="INVENTORY MANAGEMENT", font=('arial', 10, 'bold')).pack()
            new_label.pack()
            new_frame.place(x=40, y=20)
            zxx = Button(new_frame, text='     Shipping         ', font=('arial', 10, 'bold'), image=Check_Stocks,
                         compound='left',
                         bg='#B4F8C8', activebackground='red',
                         relief=RAISED, command=lambda: shipping_data(zxx))
            zxx.place(x=305, y=49)
            ue = Button(new_frame, text='Update Employee\nDatabase  ', font=('arial', 9, 'bold'),
                        image=check_employee, compound='left', bg='#B4F8C8',
                        activebackground='red', relief=RAISED, command=lambda: update_employee(ue))
            ue.place(x=40, y=212)
            uc = Button(new_frame, text='Update Customer\nDatabase  ', font=('arial', 9, 'bold'), image=customer_check,
                        compound='left', bg='#B4F8C8', relief=RAISED,
                        activebackground='red', command=lambda: update_customer(uc))
            uc.place(x=40, y=376)
            us = Button(new_frame, text=' Update Stocks    \n Database', font=('arial', 9, 'bold'), image=photo1,
                        compound='left', bg='#B4F8C8', relief=RAISED,
                        activebackground='red', command=lambda: update_stock(us))
            us.place(x=40, y=49)
            rq = Button(new_frame, text='    Return request     ', font=('arial', 9, 'bold'), image=photo2,
                        compound='left',
                        bg='#B4F8C8', relief=RAISED, activebackground='red', command=lambda: req_return(rq))
            rq.place(x=305, y=212)
            db = Button(new_frame, text='  Databases                ', font=('arial', 9, 'bold'), image=customer_data,
                        compound='left',
                        bg='#B4F8C8', activebackground='red', relief=RAISED, command=lambda: create2(db))
            db.place(x=305, y=376)
            btn1_r = Button(new_frame, text=' refresh', font=('arial', 9, 'bold'),
                            compound='left', bg='#B4F8C8', activebackground='red', relief=RAISED,
                            command=lambda: refresh(zxx, rq, ue, uc, us, db))
            btn1_r.place(x=250, y=520)

    elif username.get() == "" or password.get() == "":
        messagebox.showerror("ERROR", "Please Insert username/password")
    else:
        messagebox.showerror("ERROR", "Wrong username/password")


def delete():
    username_terminal.delete(0, END)
    password_terminal.delete(0, END)


def refresh(button, button1, button2, button3, button4, button5):
    button['state'] = 'normal'
    button1['state'] = 'normal'
    button2['state'] = 'normal'
    button3['state'] = 'normal'
    button4['state'] = 'normal'
    button5['state'] = 'normal'


def refresh_login(button):
    button['state'] = 'normal'


def req_return(button):
    new = Toplevel(main)
    new.geometry('720x620')
    new.resizable(FALSE, FALSE)
    new.title("RETURNS")
    new.config(bg='#191919')
    cursordb.execute('SELECT * FROM return_database')
    button['state'] = 'disabled'

    def filterTeeView(*args):
        ItemsOnTreeview = treeview.get_children()

        search = search_var.get()
        for z in ItemsOnTreeview:
            if search in treeview.item(z)['values'][1]:
                search_var_m = treeview.item(z)['values']
                treeview.delete(z)

                treeview.insert('', 0, values=search_var_m)

    def add_data():
        n_r_ID = r_id.get()
        n_order = o_id.get()
        n_product = product.get()
        n_reason = reason.get()
        n_quantity = quantity.get()
        n_date = date.get()
        n_status = status.get()
        cursordb.execute(
            'INSERT INTO return_database(return_ID, order_ID, product, reason , quantity, date, '
            'status)VALUES(%s, %s, %s, %s, %s, %s, %s)',
            (n_r_ID, n_order, n_product, n_reason, n_quantity, n_date, n_status))

        main_database.commit()
        treeview.insert('', END, values=(n_r_ID, n_order, n_product, n_reason, n_quantity, n_date, n_status))

    def update_data():
        selected = treeview.selection()[0]
        n_r_ID = r_id.get()
        n_order = o_id.get()
        n_product = product.get()
        n_reason = reason.get()
        n_quantity = quantity.get()
        n_date = date.get()
        n_status = status.get()
        sql = 'UPDATE return_database SET order_ID=%s, product=%s, reason=%s, ' \
              'quantity=%s, date=%s, status=%s WHERE return_ID=%s '
        value = (n_order, n_product, n_reason, n_quantity, n_date, n_status, n_r_ID)
        cursordb.execute(sql, value)
        main_database.commit()

        treeview.delete(selected)
        treeview.insert('', END, values=(n_r_ID, n_order, n_product, n_reason, n_quantity, n_date, n_status))

    def delete_data(tree):
        selected = treeview.selection()[0]
        n_r_ID = r_id.get()
        query = """Delete From return_database where return_ID=%s"""
        value = (n_r_ID,)
        cursordb.execute(query, value)
        main_database.commit()
        treeview.delete(selected)

    # entry frame
    topframe = Frame(new, bg='#C84B31')
    topframe.place(x=15, y=12, width=405, height=80)
    # tree frame
    tree_frame = Frame(new, bg='#ECDBBA')
    tree_frame.place(x=12, y=300, width=695, height=300)
    new.iconphoto(FALSE, photo2)
    Label(new, text="Returns   ", font=('Arial', 10, 'bold'), fg='white', background='#2D4263', relief=FLAT, bd=5,
          padx=40, pady=1, image=icon_return, compound='left').place(x=431, y=9)

    # search by text
    lb1 = Label(topframe, text="Check returns:", fg='black', bg='#ECDBBA')
    lb1.place(x=10, y=32)
    search_var = StringVar()
    # entry terminal
    entry = Entry(topframe, textvariable=search_var, font=('Arial', 15, 'bold'), bg='#ECDBBA')
    entry.place(x=95, y=30)
    search_var.trace('w', filterTeeView)

    # treeview
    column = ["return_ID", "order_ID", "product", "reason", "quantity", "date",
              "status"]
    treeview = ttk.Treeview(tree_frame, height=100, column=column)
    treeview.pack(fill='both')
    treeview['show'] = 'headings'
    for x in column:
        treeview.column(x, width=80)
        treeview.heading(x, text=x.capitalize())

    # inserting data
    for i in cursordb:
        treeview.insert('', END, values=i)

    function_frm = Frame(new, bg='#C84B31', width=688, height=180)
    function_frm.place(x=15, y=110)
    Label(function_frm, text='return_ID:', font=('arial', 9, 'bold'), bg='#ECDBBA').place(x=10, y=20)
    r_id = IntVar()
    Label(function_frm, text='Order ID:', font=('arial', 9, 'bold'), bg='#ECDBBA').place(x=10, y=60)
    o_id = StringVar()
    Label(function_frm, text='Product:', font=('arial', 9, 'bold'), bg='#ECDBBA').place(x=10, y=100)
    product = StringVar()
    Label(function_frm, text='Reason:', font=('arial', 9, 'bold'), bg='#ECDBBA').place(x=260, y=20)
    reason = StringVar()
    Label(function_frm, text='Quantity:', font=('arial', 9, 'bold'), bg='#ECDBBA').place(x=260, y=60)
    quantity = StringVar()
    Label(function_frm, text='Date:', font=('arial', 9, 'bold'), bg='#ECDBBA').place(x=260, y=100)
    date = StringVar()
    Label(function_frm, text='Status:', font=('arial', 9, 'bold'), bg='#ECDBBA').place(x=480, y=20)
    status = StringVar()

    e1 = Entry(function_frm, textvariable=r_id, bg='#ECDBBA')
    e1.place(x=80, y=20)
    e2 = Entry(function_frm, textvariable=o_id, bg='#ECDBBA')
    e2.place(x=80, y=60)
    e3 = Entry(function_frm, textvariable=product, bg='#ECDBBA')
    e3.place(x=80, y=100)
    e4 = Entry(function_frm, textvariable=reason, bg='#ECDBBA')
    e4.place(x=330, y=20)
    e5 = Entry(function_frm, textvariable=quantity, bg='#ECDBBA')
    e5.place(x=330, y=60)
    e6 = Entry(function_frm, textvariable=date, bg='#ECDBBA')
    e6.place(x=330, y=100)
    e7 = Entry(function_frm, textvariable=status, bg='#ECDBBA')
    e7.place(x=550, y=20)

    btn1 = Button(function_frm, text='Add', bg='green', fg='white', activeforeground='white', activebackground='green',
                  command=lambda: add_data(), width=25)
    btn1.place(x=30, y=140)
    btn2 = Button(function_frm, text='cancel', bg='red', fg='white', activeforeground='white', activebackground='red',
                  command=lambda: delete_data(treeview), width=25)
    btn2.place(x=250, y=140)
    btn3 = Button(function_frm, text='update', bg='yellow', fg='black', activeforeground='yellow',
                  activebackground='black', command=lambda: update_data(), width=25)
    btn3.place(x=470, y=140)


def shipping_data(button):
    new = Toplevel(main)
    new.geometry('720x620')
    new.resizable(FALSE, FALSE)
    new.title("shipping")
    new.config(bg='#191919')
    cursordb.execute('SELECT * FROM shipping_database')
    button['state'] = 'disabled'

    def filterTeeView(*args):
        ItemsOnTreeview = treeview.get_children()

        search = search_var.get()
        for z in ItemsOnTreeview:
            if search in treeview.item(z)['values'][1]:
                search_var_m = treeview.item(z)['values']
                treeview.delete(z)

                treeview.insert('', 0, values=search_var_m)

    def add_data():
        n_s_ID = Shipping_id.get()
        n_Product = Product.get()
        n_Status = Status.get()
        n_Quantity = Quantity.get()
        n_Date = Date.get()
        cursordb.execute(
            'INSERT INTO shipping_database(Shipping_ID, Product, Status, Quantity , Date)VALUES(%s, %s, %s, %s, %s)',
            (n_s_ID, n_Product, n_Status, n_Quantity, n_Date))

        main_database.commit()
        treeview.insert('', END, values=(n_s_ID, n_Product, n_Status, n_Quantity, n_Date))

    def update_data():
        selected = treeview.selection()[0]
        n_s_ID = Shipping_id.get()
        n_Product = Product.get()
        n_Status = Status.get()
        n_Quantity = Quantity.get()
        n_Date = Date.get()
        SQL = 'UPDATE shipping_database SET Product=%s, Status=%s, Quantity=%s, Date=%s WHERE Shipping_ID=%s'
        value = (n_Product, n_Status, n_Quantity, n_Date, n_s_ID)
        cursordb.execute(SQL, value)
        main_database.commit()

        treeview.delete(selected)
        treeview.insert('', END, values=(n_s_ID, n_Product, n_Status, n_Quantity, n_Date))

    def delete_data(tree):
        selected = treeview.selection()[0]
        n_s_ID = Shipping_id.get()
        query = """Delete From shipping_database where Shipping_ID=%s"""
        value = (n_s_ID,)
        cursordb.execute(query, value)
        main_database.commit()
        treeview.delete(selected)

    # entry frame
    topframe = Frame(new, bg='#C84B31')
    topframe.place(x=12, y=12, width=400, height=80)
    # tree frame
    tree_frame = Frame(new, bg='#ECDBBA')
    tree_frame.place(x=10, y=300, width=700, height=300)
    new.iconphoto(FALSE, ship_icon)
    Label(new, text="Shipping   ", font=('Arial', 10, 'bold'), fg='white', background='#2D4263', relief=FLAT, bd=5,
          padx=40, pady=1, image=ship_icon, compound='left').place(x=429, y=9)

    # search by text
    lb1 = Label(topframe, text="Check returns:", fg='black', bg='#ECDBBA')
    lb1.place(x=10, y=32)
    search_var = StringVar()
    # entry terminal
    entry = Entry(topframe, textvariable=search_var, font=('Arial', 15, 'bold'), bg='#ECDBBA')
    entry.place(x=95, y=30)
    search_var.trace('w', filterTeeView)

    # treeview
    column = ["Shipping ID", "Product", "Status", "Quantity", "Date"]
    treeview = ttk.Treeview(tree_frame, height=100, column=column)
    treeview.pack(fill='both')
    treeview['show'] = 'headings'
    for x in column:
        treeview.column(x, width=80)
        treeview.heading(x, text=x.capitalize())

    # inserting data
    for i in cursordb:
        treeview.insert('', END, values=i)

    function_frm = Frame(new, bg='#C84B31', width=700, height=180)
    function_frm.place(x=12, y=110)
    Label(function_frm, text='Shipping ID:', font=('arial', 9, 'bold'), bg='#ECDBBA').place(x=10, y=20)
    Shipping_id = IntVar()
    Label(function_frm, text='Product:', font=('arial', 9, 'bold'), bg='#ECDBBA').place(x=10, y=60)
    Product = StringVar()
    Label(function_frm, text='Status:', font=('arial', 9, 'bold'), bg='#ECDBBA').place(x=10, y=100)
    Status = StringVar()
    Label(function_frm, text='Quantity:', font=('arial', 9, 'bold'), bg='#ECDBBA').place(x=260, y=20)
    Quantity = IntVar()
    Label(function_frm, text='Date:', font=('arial', 9, 'bold'), bg='#ECDBBA').place(x=260, y=60)
    Date = StringVar()

    e1 = Entry(function_frm, textvariable=Shipping_id, bg='#ECDBBA')
    e1.place(x=90, y=20)
    e2 = Entry(function_frm, textvariable=Product, bg='#ECDBBA')
    e2.place(x=80, y=60)
    e3 = Entry(function_frm, textvariable=Status, bg='#ECDBBA')
    e3.place(x=80, y=100)
    e4 = Entry(function_frm, textvariable=Quantity, bg='#ECDBBA')
    e4.place(x=330, y=20)
    e5 = Entry(function_frm, textvariable=Date, bg='#ECDBBA')
    e5.place(x=330, y=60)

    btn1 = Button(function_frm, text='Add', bg='green', fg='white', activeforeground='white', activebackground='green',
                  command=lambda: add_data(), width=25)
    btn1.place(x=30, y=140)
    btn2 = Button(function_frm, text='delete', bg='red', fg='white', activeforeground='white', activebackground='red',
                  command=lambda: delete_data(treeview), width=25)
    btn2.place(x=250, y=140)
    btn3 = Button(function_frm, text='update', bg='yellow', fg='black', activeforeground='yellow',
                  activebackground='black', command=lambda: update_data(), width=25)
    btn3.place(x=470, y=140)


def create2(button):
    new = Toplevel(main)
    new.geometry('900x440')
    new.resizable(FALSE, FALSE)
    new.title("DATABASES")
    cursordb.execute('SELECT * FROM customer_database')
    new.iconphoto(FALSE, customer_data)
    button['state'] = 'disabled'

    def filterTeeView(*args):
        ItemsOnTreeview = treeview.get_children()

        search = search_var.get()
        for z in ItemsOnTreeview:
            if search in treeview.item(z)['values'][1]:
                search_var_m = treeview.item(z)['values']
                treeview.delete(z)

                treeview.insert('', 0, values=search_var_m)

    notebook = ttk.Notebook(new)
    tab1 = Frame(notebook)
    notebook.add(tab1, text='customer_database')

    # entry frame
    topframe = Frame(tab1, bg='white')
    topframe.pack()
    # tree frame
    tree_frame = Frame(tab1, bg='green')
    tree_frame.pack()
    # search by text
    lb1 = Label(topframe, text="Search Name:", fg='black', bg='white')
    lb1.place(x=10, y=32)
    search_var = StringVar()
    # entry terminal
    entry = Entry(topframe, textvariable=search_var, font=('Arial', 15, 'bold'))
    entry.place(x=95, y=30)
    search_var.trace('w', filterTeeView)

    # treeview
    column = ["Customer ID", "Customer name", "Nationality", "Adress", "Contact number", "Last visit", "Email",
              "Loyalty count"]
    treeview = ttk.Treeview(tree_frame, height=80, column=column)
    treeview.pack(fill='both')
    treeview['show'] = 'headings'
    for x in column:
        treeview.column(x, width=100)
        treeview.heading(x, text=x.capitalize())

    # inserting data
    for i in cursordb:
        treeview.insert('', END, values=i)

    # ----------------------------------------------------------------------------------------------------------
    tab2 = Frame(notebook)
    notebook.add(tab2, text='Employee management')
    ncursor.execute('SELECT * FROM employee_database')

    # entry frame
    topframe = Frame(tab2, bg='white')
    topframe.pack()
    # tree frame
    tree_frame = Frame(tab2, bg='green')
    tree_frame.pack()

    # search by text
    lb1 = Label(topframe, text="Search Name:", fg='black', bg='white')
    lb1.place(x=10, y=32)
    search_var = StringVar()
    # entry terminal
    entry = Entry(topframe, textvariable=search_var, font=('Arial', 15, 'bold'))
    entry.place(x=95, y=30)
    search_var.trace('w', filterTeeView)

    # treeview
    column = ["Employee_ID", "Full_name", "Gender", "Department", "Contact_number", "Address", "Email",
              "Absents"]
    treeview = ttk.Treeview(tree_frame, height=100, column=column)
    treeview.pack(fill='both')
    treeview['show'] = 'headings'
    for x in column:
        treeview.column(x, width=100)
        treeview.heading(x, text=x.capitalize())

    # inserting data
    for i in ncursor:
        treeview.insert('', END, values=i)

    # ----------------------------------------------------------------------------------------------------------
    tab3 = Frame(notebook)
    notebook.add(tab3, text='stock_management')
    u_cursor.execute('SELECT * FROM stock_management')

    # entry frame
    topframe = Frame(tab3, bg='white')
    topframe.pack()
    # tree frame
    tree_frame = Frame(tab3, bg='green')
    tree_frame.pack()

    # search by text
    lb1 = Label(topframe, text="Search Name:", fg='black', bg='white')
    lb1.place(x=10, y=32)
    search_var = StringVar()
    # entry terminal
    entry = Entry(topframe, textvariable=search_var, font=('Arial', 15, 'bold'))
    entry.place(x=95, y=30)
    search_var.trace('w', filterTeeView)

    # treeview
    column = ["s_no", "Item_name", "Quantity", "Unit_price", "Sold", "Discount"]
    treeview = ttk.Treeview(tree_frame, height=100, column=column)
    treeview.pack(fill='both')
    treeview['show'] = 'headings'
    for x in column:
        treeview.column(x, width=100)
        treeview.heading(x, text=x.capitalize())

    # inserting data
    for i in u_cursor:
        treeview.insert('', END, values=i)

    # ----------------------------------------------------------------------------------------------------------
    tab4 = Frame(notebook)
    notebook.add(tab4, text='Shipping database')
    s_cursor.execute('SELECT * FROM shipping_database')

    # entry frame
    topframe = Frame(tab4, bg='white')
    topframe.pack()
    # tree frame
    tree_frame = Frame(tab4, bg='green')
    tree_frame.pack()

    # search by text
    lb1 = Label(topframe, text="Search Name:", fg='black', bg='white')
    lb1.place(x=10, y=32)
    search_var = StringVar()
    # entry terminal
    entry = Entry(topframe, textvariable=search_var, font=('Arial', 15, 'bold'))
    entry.place(x=95, y=30)
    search_var.trace('w', filterTeeView)

    # treeview
    column = ["Shipping_ID", "Product", "Status", "Quantity", "Date"]
    treeview = ttk.Treeview(tree_frame, height=100, column=column)
    treeview.pack(fill='both')
    treeview['show'] = 'headings'
    for x in column:
        treeview.column(x, width=100)
        treeview.heading(x, text=x.capitalize())

    # inserting data
    for i in s_cursor:
        treeview.insert('', END, values=i)

    # ----------------------------------------------------------------------------------------------------------
    tab5 = Frame(notebook)
    notebook.add(tab5, text='return database')
    r_cursor.execute('SELECT * FROM return_database')

    # entry frame
    topframe = Frame(tab5, bg='white')
    topframe.pack()
    # tree frame
    tree_frame = Frame(tab5, bg='green')
    tree_frame.pack()

    # search by text
    lb1 = Label(topframe, text="Search Name:", fg='black', bg='white')
    lb1.place(x=10, y=32)
    search_var = StringVar()
    # entry terminal
    entry = Entry(topframe, textvariable=search_var, font=('Arial', 15, 'bold'))
    entry.place(x=95, y=30)
    search_var.trace('w', filterTeeView)

    # treeview
    column = ["return_ID", "order_ID", "product", "reason", "quantity", 'date', 'status']
    treeview = ttk.Treeview(tree_frame, height=50, column=column)
    treeview.pack(fill='both')
    treeview['show'] = 'headings'
    for x in column:
        treeview.column(x, width=100)
        treeview.heading(x, text=x.capitalize())

    # inserting data
    for i in r_cursor:
        treeview.insert('', END, values=i)

    notebook.pack()


def update_stock(button):
    new = Toplevel(main)
    new.geometry('800x650')
    new.resizable(FALSE, FALSE)
    new.title("UPDATE CUSTOMER DATABASE")
    cursordb.execute('SELECT * FROM stock_management')
    new.config(bg="#0F2C67")
    new.iconphoto(FALSE, photo1)
    button['state'] = 'disabled'

    def add_data():
        n_s_no = s_no.get()
        n_Item_name = Item_name.get()
        n_Quantity = Quantity.get()
        n_Unit_price = Unit_price.get()
        n_Sold = Sold.get()
        n_discount = discount.get()
        cursordb.execute(
            'INSERT INTO stock_management(s_no, Item_name, Quantity, Unit_price, Sold, Discount)VALUES(%s, %s, %s, '
            '%s, %s, %s)', (n_s_no, n_Item_name, n_Quantity, n_Unit_price, n_Sold, n_discount))

        main_database.commit()
        treeview.insert('', END, values=(n_s_no, n_Item_name, n_Quantity, n_Unit_price, n_Sold, n_discount))

    def update_data():
        selected = treeview.selection()[0]
        n_s_no = s_no.get()
        n_Item_name = Item_name.get()
        n_Quantity = Quantity.get()
        n_Unit_price = Unit_price.get()
        n_Sold = Sold.get()
        n_discount = discount.get()
        sql = 'UPDATE stock_management SET Item_name=%s, Quantity=%s, Unit_price=%s,Sold=%s, Discount=%s WHERE s_no=%s'
        value = (n_Item_name, n_Quantity, n_Unit_price, n_Sold, n_discount, n_s_no)
        cursordb.execute(sql, value)
        main_database.commit()

        treeview.delete(selected)
        treeview.insert('', END, values=(n_s_no, n_Item_name, n_Quantity, n_Unit_price, n_Sold, n_discount))

    def delete_data(tree):
        selected = treeview.selection()[0]
        n_s_no = s_no.get()
        query = """Delete From stock_management where s_no=%s"""
        value = (n_s_no,)
        cursordb.execute(query, value)
        main_database.commit()
        treeview.delete(selected)

    def filterTeeView(*args):
        ItemsOnTreeview = treeview.get_children()

        search = search_var.get()
        for z in ItemsOnTreeview:
            if search in treeview.item(z)['values'][1]:
                search_var_m = treeview.item(z)['values']
                treeview.delete(z)

                treeview.insert('', 0, values=search_var_m)

    ent_frm = Frame(new, bg='#F3950D', height=230, width=300)
    ent_frm.place(x=40, y=130)
    Label(ent_frm, text='S.No:', font=('arial', 10, 'bold'), bg='#F3950D').place(x=10, y=10)
    Label(ent_frm, text='Item name:', font=('arial', 10, 'bold'), bg='#F3950D').place(x=10, y=50)
    Label(ent_frm, text='Quantity:', font=('arial', 10, 'bold'), bg='#F3950D').place(x=10, y=90)
    Label(ent_frm, text='Unit price:', font=('arial', 10, 'bold'), bg='#F3950D').place(x=10, y=130)
    Label(ent_frm, text='Sold:', font=('arial', 10, 'bold'), bg='#F3950D').place(x=10, y=170)
    Label(ent_frm, text='Discount:', font=('arial', 10, 'bold'), bg='#F3950D').place(x=10, y=200)

    s_no = IntVar()
    terminal1 = Entry(ent_frm, textvariable=s_no, bg='#F4E185')
    Item_name = StringVar()
    terminal2 = Entry(ent_frm, textvariable=Item_name, bg='#F4E185')
    Quantity = StringVar()
    terminal3 = Entry(ent_frm, textvariable=Quantity, bg='#F4E185')
    Unit_price = StringVar()
    terminal4 = Entry(ent_frm, textvariable=Unit_price, bg='#F4E185')
    Sold = IntVar()
    terminal5 = Entry(ent_frm, textvariable=Sold, bg='#F4E185')
    discount = IntVar()
    terminal6 = Entry(ent_frm, textvariable=discount, bg='#F4E185')

    terminal1.place(x=70, y=10)
    terminal2.place(x=100, y=50)
    terminal3.place(x=80, y=90)
    terminal4.place(x=90, y=130)
    terminal5.place(x=60, y=170)
    terminal6.place(x=80, y=200)

    # treeview frame
    tree_frame = Frame(new, bg='white')
    tree_frame.place(x=40, y=390, width=720, height=220)
    # treeview
    column = ["s_no", "Item_name", "Quantity", "Unit_price", "Sold", "Discount"]
    treeview = ttk.Treeview(tree_frame, height=100, column=column)
    treeview.pack(fill='both')
    treeview['show'] = 'headings'

    for x in column:
        treeview.column(x, width=80)
        treeview.heading(x, text=x.capitalize())

    # inserting data
    for i in cursordb:
        treeview.insert('', END, values=i)

    # title
    title_frm = Frame(new, bg='#CD1818', height=90, width=720)
    title_frm.place(x=40, y=20)
    Label(title_frm, text='STOCK MANAGEMENT', font=('arial', 40, 'bold'), bg='#CD1818').place(x=50, y=10)

    # search frame
    search_var = StringVar()
    s_frm = Frame(new, bg='#F3950D', height=70, width=400)
    s_frm.place(x=360, y=290)
    Label(s_frm, text='Check Stock:', bg='#F3950D', fg='black', font=('arial', 9, 'bold')).place(x=10, y=20)
    search_box = Entry(s_frm, textvariable=search_var, width=40, bg='#F4E185')
    search_box.place(x=100, y=20)
    search_var.trace('w', filterTeeView)

    # button frame
    b_frm = Frame(new, bg='#F3950D', height=130, width=400)
    b_frm.place(x=360, y=130)
    Button(b_frm, text='Add', bg='green', fg='white', activeforeground='white',
           activebackground='green', height=2, width=22, font=('arial', 9, 'bold'),
           command=lambda: add_data()).place(x=20, y=10)
    Button(b_frm, text='delete', bg='red', fg='white', activeforeground='white',
           activebackground='red', height=2, width=22, font=('arial', 9, 'bold'),
           command=lambda: delete_data(treeview)).place(x=210, y=10)
    Button(b_frm, text='update', bg='yellow', fg='black', activeforeground='black',
           activebackground='yellow', height=2, width=32, font=('arial', 9, 'bold'),
           command=lambda: update_data()).place(x=80, y=70)


def update_employee(button):
    new = Toplevel(main)
    new.geometry('1100x650')
    new.resizable(FALSE, FALSE)
    new.title("EMPLOYEE MANAGEMENT")
    new.config(bg="#FBE7C6")
    cursordb.execute('SELECT * FROM employee_database')
    button['state'] = 'disabled'

    def add_data():
        n_Employee_ID = Employee_ID.get()
        n_Full_name = Full_name.get()
        n_Gender = Gender.get()
        n_Department = Department.get()
        n_Contact_number = Contact_number.get()
        n_Address = Address.get()
        n_email = Email.get()
        n_Absents = Absents.get()
        cursordb.execute(
            'INSERT INTO employee_database(Employee_ID, Full_name, Gender, Department, Contact_number, Address, '
            'Email, Absents)VALUES(%s, %s, %s, %s, %s, %s, %s, %s)',
            (n_Employee_ID, n_Full_name, n_Gender, n_Department,
             n_Contact_number, n_Address, n_email,
             n_Absents))

        main_database.commit()
        treeview.insert('', END, values=(n_Employee_ID, n_Full_name, n_Gender, n_Department,
                                         n_Contact_number, n_Address, n_email, n_Absents))

    def update_data():
        selected = treeview.selection()[0]
        n_Employee_ID = Employee_ID.get()
        n_Full_name = Full_name.get()
        n_Gender = Gender.get()
        n_Department = Department.get()
        n_Contact_number = Contact_number.get()
        n_Address = Address.get()
        n_email = Email.get()
        n_Absents = Absents.get()
        sql = 'UPDATE employee_database SET Full_name=%s, Gender=%s, Department=%s, Contact_number=%s,Address=%s, ' \
              'Email=%s, Absents=%s WHERE Employee_ID=%s '
        value = (n_Full_name, n_Gender, n_Department, n_Contact_number, n_Address, n_email, n_Absents, n_Employee_ID)
        cursordb.execute(sql, value)
        main_database.commit()

        treeview.delete(selected)
        treeview.insert('', END, values=(n_Employee_ID, n_Full_name, n_Gender, n_Department, n_Contact_number,
                                         n_Address, n_email, n_Absents))

    def delete_data(tree):
        selected = treeview.selection()[0]
        n_Full_name = Full_name.get()
        query = """Delete From employee_database where Full_name=%s"""
        value = (n_Full_name,)
        cursordb.execute(query, value)
        main_database.commit()
        treeview.delete(selected)

    def filterTeeView(*args):
        ItemsOnTreeview = treeview.get_children()

        search = search_var.get()
        for z in ItemsOnTreeview:
            if search in treeview.item(z)['values'][1]:
                search_var_m = treeview.item(z)['values']
                treeview.delete(z)

                treeview.insert('', 0, values=search_var_m)

    # user input frame
    frm1 = Frame(new, height=600, width=350, bg='white')
    frm1.place(x=20, y=20)
    Button(frm1, text='Add', bg='green', fg='white', activeforeground='white',
           activebackground='green', height=2, width=22, font=('arial', 9, 'bold'), command=lambda: add_data()).place(
        x=10, y=500)
    Button(frm1, text='Delete', bg='red', fg='white', activeforeground='white',
           activebackground='red', height=2, width=20, font=('arial', 9, 'bold'),
           command=lambda: delete_data(treeview)).place(x=190, y=500)
    Button(frm1, text='Update', bg='yellow', fg='black', activeforeground='black',
           activebackground='yellow', height=2, width=46, font=('arial', 9, 'bold'),
           command=lambda: update_data()).place(x=10, y=550)
    Label(frm1, text='Employee_ID', font=('arial', 9, 'bold')).place(x=10, y=10)
    Employee_ID = IntVar()
    e1 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Employee_ID)
    e1.place(x=10, y=30)
    Full_name = StringVar()
    Label(frm1, text='Full_name', font=('arial', 9, 'bold')).place(x=10, y=70)
    e2 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Full_name)
    e2.place(x=10, y=90)
    Gender = StringVar()
    Label(frm1, text='Gender', font=('arial', 9, 'bold')).place(x=10, y=120)
    e3 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Gender)
    e3.place(x=10, y=150)
    Department = StringVar()
    Label(frm1, text='Department', font=('arial', 9, 'bold')).place(x=10, y=190)
    e4 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Department)
    e4.place(x=10, y=220)
    Contact_number = StringVar()
    Label(frm1, text='Contact_number', font=('arial', 9, 'bold')).place(x=10, y=250)
    e5 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Contact_number)
    e5.place(x=10, y=280)
    Address = StringVar()
    Label(frm1, text='Address', font=('arial', 9, 'bold')).place(x=10, y=310)
    e6 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Address)
    e6.place(x=10, y=340)
    Email = StringVar()
    Label(frm1, text='Email', font=('arial', 9, 'bold')).place(x=10, y=370)
    e7 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Email)
    e7.place(x=10, y=400)
    Absents = IntVar()
    Label(frm1, text='Absents', font=('arial', 9, 'bold')).place(x=10, y=430)
    e8 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Absents)
    e8.place(x=10, y=460)

    # treeview frame
    tree_frame = Frame(new, bg='white')
    tree_frame.place(x=380, y=200, width=700, height=420)
    # treeview
    column = ["Employee_ID", "Full_name", "Gender", "Department", "Contact_number", "Address", "Email",
              "Absents"]
    treeview = ttk.Treeview(tree_frame, height=100, column=column)
    treeview.pack(fill='both')
    treeview['show'] = 'headings'

    for x in column:
        treeview.column(x, width=80)
        treeview.heading(x, text=x.capitalize())

    # inserting data
    for i in cursordb:
        treeview.insert('', END, values=i)
    # title frame
    topframe = Frame(new, bg='white')
    topframe.place(x=380, y=20, width=700, height=80)
    Label(topframe, text='UPDATE EMPLOYEE', font=('arial', 20, 'bold'), fg='black', bg='white', image=check_employee,
          compound='left').pack()
    # search frame
    search_var = StringVar()
    sframe = Frame(new, bg='black')
    sframe.place(x=380, y=120, width=340, height=70)
    # search by text
    lb1 = Label(sframe, text="Search Name:", fg='black', bg='white')
    lb1.place(x=10, y=32)
    search_var.trace('w', filterTeeView)
    # entry terminal
    entry = Entry(sframe, textvariable=search_var, font=('Arial', 15, 'bold'))
    entry.place(x=95, y=30)


def update_customer(button):
    new = Toplevel(main)
    new.geometry('1200x650')
    new.resizable(FALSE, FALSE)
    new.title("CUSTOMER MANAGEMENT")
    new.config(bg="#FBE7C6")
    cursordb.execute('SELECT * FROM customer_database')
    new.iconphoto(FALSE, customer_check)
    button['state'] = 'disabled'

    def add_data():
        n_Customer_ID = Customer_ID.get()
        n_Customer_name = Customer_name.get()
        n_Nationality = Nationality.get()
        n_Address = Address.get()
        n_Contact_number = Contact_number.get()
        n_Last_visit = Last_visit.get()
        n_Email = Email.get()
        n_Loyalty_count = Loyalty_count.get()
        cursordb.execute(
            'INSERT INTO customer_database(Customer_ID, Customer_name, Nationality, Adress, Contact_number, '
            'Last_visit, ''Email, Loyalty_count)VALUES(%s, %s, %s, %s, %s, %s, %s, %s)',
            (n_Customer_ID, n_Customer_name, n_Nationality, n_Address,
             n_Contact_number, n_Last_visit, n_Email,
             n_Loyalty_count))

        main_database.commit()
        treeview.insert('', END, values=(n_Customer_ID, n_Customer_name, n_Nationality, n_Address,
                                         n_Contact_number, n_Last_visit, n_Email, n_Loyalty_count))

    def update_data():
        selected = treeview.selection()[0]
        n_Customer_ID = Customer_ID.get()
        n_Customer_name = Customer_name.get()
        n_Nationality = Nationality.get()
        n_Address = Address.get()
        n_Contact_number = Contact_number.get()
        n_Last_visit = Last_visit.get()
        n_Email = Email.get()
        n_Loyalty_count = Loyalty_count.get()
        sql = 'UPDATE customer_database SET Customer_name=%s, Nationality=%s, Adress=%s, Contact_number=%s, ' \
              'Last_visit=%s, Email=%s, Loyalty_count=%s WHERE Customer_ID=%s '
        value = (n_Customer_name, n_Nationality, n_Address, n_Contact_number, n_Last_visit, n_Email,
                 n_Loyalty_count, n_Customer_ID)
        cursordb.execute(sql, value)
        main_database.commit()

        treeview.delete(selected)
        treeview.insert('', END, values=(n_Customer_ID, n_Customer_name, n_Nationality, n_Address,
                                         n_Contact_number, n_Last_visit, n_Email, n_Loyalty_count))

    def delete_data(tree):
        selected = treeview.selection()[0]
        n_Customer_name = Customer_name.get()
        query = """Delete From customer_database where Customer name=%s"""
        value = (n_Customer_name,)
        cursordb.execute(query, value)
        main_database.commit()
        treeview.delete(selected)

    def filterTeeView(*args):
        ItemsOnTreeview = treeview.get_children()

        search = search_var.get()
        for z in ItemsOnTreeview:
            if search in treeview.item(z)['values'][1]:
                search_var_m = treeview.item(z)['values']
                treeview.delete(z)

                treeview.insert('', 0, values=search_var_m)

    # user input frame
    frm1 = Frame(new, height=600, width=350, bg='white')
    frm1.place(x=20, y=20)
    Button(frm1, text='Add', bg='green', fg='white', activeforeground='white',
           activebackground='green', height=2, width=22, font=('arial', 9, 'bold'), command=lambda: add_data()).place(
        x=10, y=500)
    Button(frm1, text='Delete', bg='red', fg='white', activeforeground='white',
           activebackground='red', height=2, width=20, font=('arial', 9, 'bold'),
           command=lambda: delete_data(treeview)).place(x=190, y=500)
    Button(frm1, text='Update', bg='yellow', fg='black', activeforeground='black',
           activebackground='yellow', height=2, width=46, font=('arial', 9, 'bold'),
           command=lambda: update_data()).place(x=10, y=550)
    Label(frm1, text='Customer ID', font=('arial', 9, 'bold')).place(x=10, y=10)
    Customer_ID = IntVar()
    e1 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Customer_ID)
    e1.place(x=10, y=30)
    Customer_name = StringVar()
    Label(frm1, text='Customer name', font=('arial', 9, 'bold')).place(x=10, y=70)
    e2 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Customer_name)
    e2.place(x=10, y=90)
    Nationality = StringVar()
    Label(frm1, text='Nationality', font=('arial', 9, 'bold')).place(x=10, y=120)
    e3 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Nationality)
    e3.place(x=10, y=150)
    Address = StringVar()
    Label(frm1, text='Address', font=('arial', 9, 'bold')).place(x=10, y=190)
    e4 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Address)
    e4.place(x=10, y=220)
    Contact_number = StringVar()
    Label(frm1, text='Contact number', font=('arial', 9, 'bold')).place(x=10, y=250)
    e5 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Contact_number)
    e5.place(x=10, y=280)
    Last_visit = StringVar()
    Label(frm1, text='Last visit', font=('arial', 9, 'bold')).place(x=10, y=310)
    e6 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Last_visit)
    e6.place(x=10, y=340)
    Email = StringVar()
    Label(frm1, text='Email', font=('arial', 9, 'bold')).place(x=10, y=370)
    e7 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Email)
    e7.place(x=10, y=400)
    Loyalty_count = IntVar()
    Label(frm1, text='Loyalty count', font=('arial', 9, 'bold')).place(x=10, y=430)
    e8 = Entry(frm1, font=('arial', 10, 'bold'), textvariable=Loyalty_count)
    e8.place(x=10, y=460)

    # treeview frame
    tree_frame = Frame(new, bg='white')
    tree_frame.place(x=380, y=200, width=800, height=420)
    # treeview
    column = ["Customer ID", "Customer name", "Nationality", "Address", "Contact number", "Last visit", "Email",
              "Loyalty count"]
    treeview = ttk.Treeview(tree_frame, height=100, column=column)
    treeview.pack(fill='both')
    treeview['show'] = 'headings'

    for x in column:
        treeview.column(x, width=80)
        treeview.heading(x, text=x.capitalize())

    # inserting data
    for i in cursordb:
        treeview.insert('', END, values=i)
    # title frame
    topframe = Frame(new, bg='white')
    topframe.place(x=380, y=20, width=800, height=80)
    Label(topframe, text='CUSTOMER MANAGEMENT', font=('arial', 20, 'bold'), fg='black', bg='white',
          image=check_employee,
          compound='left').pack()
    # search frame
    search_var = StringVar()
    sframe = Frame(new, bg='black')
    sframe.place(x=380, y=120, width=340, height=70)
    # search by text
    lb1 = Label(sframe, text="Search Name:", fg='black', bg='white')
    lb1.place(x=10, y=32)
    search_var = StringVar()
    search_var.trace('w', filterTeeView)
    # entry terminal
    entry = Entry(sframe, textvariable=search_var, font=('Arial', 15, 'bold'))
    entry.place(x=95, y=30)


def register(button):
    button['state'] = 'disabled'

    def ok():
        def add_data():
            n_user = trm1.get()
            n_pass = trm2.get()
            n_id = trm3.get()
            sql = 'INSERT INTO login_credentials(userID, username, passowrd)VALUES(%s, %s, %s)'
            values = (n_id, n_user, n_pass)
            cursordb.execute(sql, values)
            if sql:
                messagebox.showinfo('done', 'done')
            else:
                messagebox.showerror('error', 'eoor')

            main_database.commit()

        pin = ent1.get()
        if pin == '320910':
            messagebox.showinfo('DONE', 'Successful')
            new.destroy()
            window = Toplevel(main)
            window.title('Register')
            window.geometry('400x400')
            newf = Frame(window, bg='white', height=376, width=376)
            newf.place(x=11, y=10)
            n_trm1 = StringVar()
            n_trm2 = StringVar()
            n_trm3 = IntVar()
            Label(newf, text='userID', font=('arial', 9, 'bold'), bg='white').place(x=20, y=10)
            trm3 = Entry(newf, font=('arial', 10, 'bold'), textvariable=n_trm3)
            trm3.place(x=20, y=30)
            Label(newf, text='USERNAME', font=('arial', 20, 'bold'), bg='white').place(x=20, y=60)
            trm1 = Entry(newf, font=('arial', 20, 'bold'), textvariable=n_trm1)
            trm1.place(x=20, y=110)
            Label(newf, text='PASSWORD', font=('arial', 20, 'bold'), bg='white').place(x=20, y=160)
            trm2 = Entry(newf, font=('arial', 20, 'bold'), textvariable=n_trm2)
            trm2.place(x=20, y=210)
            r_btn = Button(newf, text='Register', font=('arial', 17, 'bold'), bg='green', fg='white',
                           activeforeground='white', activebackground='green', command=lambda: add_data())
            r_btn.place(x=20, y=290)
        elif pin == '':
            messagebox.showerror('ERROR', 'PLEASE INPUT PIN')
        else:
            messagebox.showerror('ERROR', 'WRONG PIN')

    new = Toplevel(main)
    new.title('REGISTER')
    new.geometry('320x140')
    Label(new, text='PIN', font=('arial', 12, 'bold')).place(x=145, y=10)
    ent1 = Entry(new, font=('arial', 12, 'bold'))
    ent1.place(x=72, y=45)
    Button(new, text='submit', bg='green', fg='white', activebackground='green',
           activeforeground='white', command=ok).place(x=140, y=80)


main = Tk()
main.geometry("650x600")
main.resizable(FALSE, FALSE)
main.config(bg="#064663")
main.title("LOGIN")
icon = PhotoImage(file='user.png')
main.iconphoto(True, icon)
Check_Stocks = PhotoImage(file='shipped (1).png')
photo1 = PhotoImage(file='Hnet.com-imagemain.png')
photo2 = PhotoImage(file='n_return.png')
check_employee = PhotoImage(file='background check.png')
customer_check = PhotoImage(file='customer check.png')
customer_data = PhotoImage(file='database for customer.png')
employee_icon = PhotoImage(file='employee (1).png')
stock_icon = PhotoImage(file='inventory (1).png')
customer_icon = PhotoImage(file='male-customer (1).png')
d_icon = PhotoImage(file='dashboard1.png')
ship_icon = PhotoImage(file='80x80 ship.png')
icon_return = PhotoImage(file='80x80 return.png')

frame = Frame(main, bg="white", width=370, height=500, relief=SUNKEN, bd=5)
frame.place(x=265, y=50)

icon = PhotoImage(file='Webp.net-resizeimage.png')
label = Label(main, background='#064663', image=icon, compound='bottom')
label.place(x=80, y=200)

user = Label(frame, text='USERNAME:', font=('arial', 16, 'bold'), bg="white")
passw = Label(frame, text='PASSWORD:', font=('arial', 16, 'bold'), bg="white")
user.place(x=20, y=68)
passw.place(x=20, y=220)

username = StringVar()
password = StringVar()

username_terminal = Entry(frame, textvariable=username, width=14, bd=2, font=('arial', 30))
username_terminal.place(x=20, y=120)

password_terminal = Entry(frame, textvariable=password, width=14, bd=2, font=('arial', 30), show='*')
password_terminal.place(x=20, y=280)

login_button = Button(frame, text='Login', height='2', width=20, bg='#189AB4', fg='#D4F1F4', bd=0,
                      activebackground='#189AB4', activeforeground='#D4F1F4', command=login_verification)
login_button.place(x=20, y=420)
del_button = Button(frame, text='Clear', height='2', width=20, bg='#189AB4', fg='#D4F1F4', bd=0,
                    activebackground='#189AB4', activeforeground='#D4F1F4', command=delete)
del_button.place(x=20, y=360)

reg_button = Button(frame, text='Register', height=3, width=16, bg='#7267CB', fg='#D4F1F4', bd=0,
                    activebackground='#189AB4', activeforeground='#D4F1F4', command=lambda: register(reg_button))
reg_button.place(x=200, y=360)

ref_button = Button(frame, text='Refresh', height=2, width=16, bg='green', fg='#D4F1F4', bd=0,
                    activebackground='green', activeforeground='#D4F1F4', command=lambda: refresh_login(reg_button))
ref_button.place(x=200, y=420)

main.mainloop()
